# =============================================================================
# Lexia API - Machine Learning Requirements
# =============================================================================
# These dependencies require GPU support for production use
# Install with: pip install -r requirements-ml.txt
# =============================================================================

# -----------------------------------------------------------------------------
# PyTorch (CUDA 12.1)
# For different CUDA versions, see: https://pytorch.org/get-started/locally/
# -----------------------------------------------------------------------------
torch>=2.1.0
torchaudio>=2.1.0

# -----------------------------------------------------------------------------
# LLM Inference (vLLM)
# Requires NVIDIA GPU with CUDA support
# -----------------------------------------------------------------------------
vllm>=0.3.0
transformers>=4.37.0
accelerate>=0.26.0
safetensors>=0.4.0
sentencepiece>=0.1.99
tokenizers>=0.15.0

# -----------------------------------------------------------------------------
# Speech-to-Text (Whisper)
# -----------------------------------------------------------------------------
# Option 1: OpenAI Whisper (slower, simpler)
# openai-whisper>=20231117

# Option 2: Faster-Whisper (CTranslate2 backend, recommended)
faster-whisper>=0.10.0
ctranslate2>=4.0.0

# Hugging Face Whisper integration
# transformers already included above

# -----------------------------------------------------------------------------
# Speaker Diarization (Pyannote)
# Requires Hugging Face token for model access
# -----------------------------------------------------------------------------
pyannote.audio>=3.1.0
pyannote.core>=5.0.0
speechbrain>=1.0.0

# -----------------------------------------------------------------------------
# Additional ML utilities
# -----------------------------------------------------------------------------
einops>=0.7.0
flash-attn>=2.5.0;platform_system=="Linux"
